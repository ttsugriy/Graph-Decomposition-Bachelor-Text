Головна ідея алгоритму Декомпозиція (алгоритм \ref{alg:factor}) полягає в наступному: Нехай $G$ є оптимально маркований граф добутку із (невідомою) маркувальною функцією $g$.
Починаючи з графа $G(1)$ обчислюється маркувальна функція $f$ для $G(2),\dots,G(k-1)$, такі що $G(k-1)$ є МЧГД і $f \triangleleft g$.
Для приписування правильних маркерів вершинам в рівні $k$, застосовується алгоритм Завершення (алгоритм \ref{alg:completion}).
Якщо це не можливо для деякого $v$, то $v$ є вершиною одиничного розрізу і за допомогою Об'єднання (алгоритм \ref{alg:combine}) коректується маркування.
Якщо всі вершини в рівні $k$ є маркованими, вони перевіряються на сумісність; маркери інших вершин залишаються незмінними.
Якщо для вершини $v$ тест на сумісність не проходить, то вершина $v$ - є вершиною одиничного розрізу і запускається Об'єднання (алгоритм \ref{alg:combine}).
В такому разі $f \triangleleft g$ вірне для $G(k)$.
Нарешті, утворюється МГД $G$ і $f \triangleleft g$ означає $f=g$.

\input alg_combine

Алгоритм Об'єднання (\ref{alg:combine}) для заданого МГД, де невідомі маркери усіх вершин неодиничного розрізу, знаходить правильні маркери усіх вершин.

\input alg_completion

\input alg_consistency_test

\input alg_factor
